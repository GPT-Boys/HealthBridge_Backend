# =============================================
# üåê HealthBridge Backend - Multi-Service Stack
# =============================================

name: healthbridge-backend

services:
  # ----------------------
  # üß© MongoDB Database
  # ----------------------
  mongodb:
    image: mongo:7.0
    container_name: healthbridge-mongo
    restart: always
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: password123
    volumes:
      - mongodb_data:/data/db
    networks:
      - healthbridge-network

  # ----------------------
  # üîê Auth Service
  # ----------------------
  auth-service:
    build:
      context: ./auth-service
      dockerfile: Dockerfile
    container_name: healthbridge-auth
    env_file:
      - ./auth-service/.env.development
    ports:
      - "3001:3001"
    depends_on:
      - mongodb
    networks:
      - healthbridge-network
    restart: always

  # ----------------------
  # üë• User Service
  # ----------------------
  user-service:
    build:
      context: ./user-service
      dockerfile: Dockerfile
    container_name: healthbridge-user
    env_file:
      - ./user-service/.env.development
    ports:
      - "3002:3002"
    depends_on:
      - mongodb
      - auth-service
    networks:
      - healthbridge-network
    restart: always

  # ----------------------
  # üìÖ Appointment Service
  # ----------------------
  appointment-service:
    build:
      context: ./appointment-service
      dockerfile: Dockerfile
    container_name: healthbridge-appointment
    env_file:
      - ./appointment-service/.env.development
    ports:
      - "3003:3003"
    depends_on:
      - mongodb
      - auth-service
      - user-service
    networks:
      - healthbridge-network
    restart: always

  # ----------------------
  # üîî Notification Service
  # ----------------------
  notification-service:
    build:
      context: ./notification-service
      dockerfile: Dockerfile
    container_name: healthbridge-notification
    env_file:
      - ./notification-service/.env.development
    ports:
      - "3004:3004"
    depends_on:
      - mongodb
      - auth-service
    networks:
      - healthbridge-network
    restart: always

  # ----------------------
  # üí∞ Billing Service
  # ----------------------
  billing-service:
    build:
      context: ./billing-service
      dockerfile: Dockerfile
    container_name: healthbridge-billing
    env_file:
      - ./billing-service/.env.development
    ports:
      - "3005:3005"
    depends_on:
      - mongodb
      - auth-service
      - user-service
    networks:
      - healthbridge-network
    restart: always

# --------------------------
# üóÑÔ∏è Shared Volumes & Network
# --------------------------
volumes:
  mongodb_data:

networks:
  healthbridge-network:
    driver: bridge
